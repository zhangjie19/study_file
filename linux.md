# linux命令

## 初级命令学习

### 1.目录与路径

- 在linux中，一切皆文件。所以，linux和windows目录有很大的不同，它没有明确的盘符，它的目录就像一棵大树一样，顶层目录就是根目录：/，然后下面又有很多个分支，分支可以再分，从而形成一个庞大的文件系统，就像这样
  - ![image-20221105211047163](.\img\image-20221105211047163.png)

- 目录的含义一

  | 一级目录    | 作用说明                                                     |
  | ----------- | ------------------------------------------------------------ |
  | **/bin**    | 主要存放一些常用的系统命令，如：ls cat mkdir，存放的命令普通用户和超级用户都可以执行 |
  | **/sbin**   | 存放和系统环境设置相关的命令，只有超级用户可以使用这些命令   |
  | /usr/sbin   | 存放系统管理命令，例如多数服务程序，只有超级用户可以使用     |
  | /boot       | 系统启动目录，存放系统启动相关的文件，如内核文件和启动引导程序文件 |
  | /dev        | 设备文件保存目录，保存所有硬件设备文件                       |
  | **/etc**    | 存放配置文件，系统内所有采用默认安装方式（rpm）的服务的配置文件，都保存再这里，如用户账户和密码，服务的启动脚本 |
  | /home       | 普通用户的家目录，所有普通用户的家目录就是在/home下简历一个和用户名同名的目录，如用户user1的家目录了就是/home/user1 |
  | /lib        | 系统调用的函数库目录                                         |
  | /lost+found | 备份恢复目录，平时是空的，发生宕机时，可以修复已经损坏的文件系统 |

- 目录的含义二

  | 二级目录  | 作用说明                                                     |
  | --------- | ------------------------------------------------------------ |
  | /media    | 挂载目录，挂载多媒体设备                                     |
  | **/mnt**  | 挂载目录，可以挂载U盘，硬盘                                  |
  | /opt      | 第三方安装的软件保存目录，放置和安装其他软件的位置，但现在一般把软件放在/usr/local目录下 |
  | /proc     | 虚拟文件系统，数据保存在内存中，主要保存系统的内核，进程，外设 |
  | /sys      | 和/proc类似，主要存放与系统相关的信息                        |
  | **/root** | 超级用户的家目录                                             |
  | /srv      | 服务数据目录，一些服务启动之后，可以在这个目录中保存所需要的数据 |
  | /tmp      | 临时目录，所有用户可以访问和写入                             |
  | /var      | 动态文件保存位置，主要保存缓存，日志文件                     |

### 2.目录操作命令

1. 文件查看命令

   - 全文查看：cat
     - -b为文件内容加上行号，但空行不算
     - -n为文件内容加上行号

   - 分页查看：more less

   - 部分查看：head tail

2. 文件的编辑

   - vi/vim分三种模式，分别是命令模式（一般模式），编辑模式（插入模式）、末行模式（命令行模式）
     1. 命令模式
        - 上下移动光标
          - G：快速跳到文件内容的最后一行
          - gg：快速跳到文本的第一行
          - 按「ctrl」+「b」：屏幕往"后"移动一页
          - 按「ctrl」+「f」：屏幕往"前"移动一页。
          - 按「ctrl」+「u」：屏幕往"后"移动半页。
          - 按「ctrl」+「d」：屏幕往"前"移动半页。
          - 按数字「0」：移到文章的开头。
          - 按「G」：移动到文章的最后。
          - 按「$」：移动到光标所在行的"行尾"。
          - 按「^」：移动到光标所在行的"行首"
          - 按「w」：光标跳到下个字的开头
          - 按「e」：光标跳到下个字的字尾
          - 按「b」：光标回到上个字的开头
          - 按「#l」：光标移到该行的第#个位置，如：5l,56l。
        
        - 删除某个字符
          - delete按键
          - x：删掉一个字符（删除光标后面的字符）
          - nx：删掉一个字符（删除光标后面的字符，n是具体的数字） 3x，删掉3个字符
          - X：删掉一个字符（删除光标前面的字符）
          - nX：删掉一个字符（删除光标前面的字符，n是具体的数字）3X，删掉3个字符
        - 删除某行内容
          - dd：删除一行内容
          - ndd：删除多行内容，n是具体的数字
          - dd：剪切一行内容
          - p：粘贴（在光标的下一行）
          - P：粘贴（在光标的上一行
        - 复制、粘贴一行或者多行
          - yy：复制一行的内容
          - nyy：复制一行的内容，n是具体的数字
          - p：粘贴（在光标的下一行）
          - P：粘贴（在光标的上一行
        - 撤销
          - u：撤销操作
        - 替换
          - [r]：替换光标所在处的字符。
          - [R]：替换光标所到之处的字符，直到按下「ESC」键为止
     2. 编辑模式
        - 模式切换
          - 通过输入a、i、o进入编辑模式
          - 按Esc退出编辑模式进入命令模式
        - 命令模式下输入a：光标往后移动一格，输入的内容从光标前一个位置开始插入
        - 命令模式下输入i：光标不会移动，新输入的内容从光标之前开始写入
        - 命令模式下输入o：光标会另起一行，新输入的内容从光标之前开始写入
     3. 末行模式
        - 模式切换
          - 命令模式切换末行模式 ，输入冒号
          - 末行模式切换命令模式 ，按ESC
        - 保存、退出
          - w：保存
          - q：退出
          - wq：保存并退出
          - w！：强制保存
          - q！：强制退出
          - wq！：强制保存并退出
        - 显示行号 
          - set nu  设置行号
          - set nonu 取消行号
        - 替换
          - 1,$s/要替换内容/新内容/g  1是第一行到\$最后一行
        - 查找
          - /要查找的内容
            - n：向下查找
            - N：反向查找

   ---

   

3. 链接文件

   - ln命令用于创建链接，链接类似于Windows下的“快捷方式”，不过链接的功能要好用。ln命令支持两种链接，一种是硬链接，一种是符号链接（软连接）

     - 硬链接

       硬链接想当于拷贝了一份源文件，文件的内容和源文件的内容一摸一样，如果源文件被删掉，硬链接文件还可以正常使用。但是不能对目录创建硬链接

       - ln -d 文件路径+空格+指定路径，不加指定路径，默认放当前路径

     - 符号链接

       符号链接就是再简历一个独立的文件，而这个文件会让数据读取操作指向它链接的那个源文件。由于只是利用文件作为指向的动作，所以当源文件被删除后，符号链接文件也就打不开了

       - ln -s 文件路径+空格+指定路径，不加指定路径，默认放当前路径

   ---

   

4. 文件的搜索

   - find 范围 选项 条件

     ​	选项：

     - 文件名查找   -name
       			- -iname 忽略文件名大小写
     - 文件大小查找 -size
       - \+30大于30kb
       - \-30小于30kb
       - +1M大于1兆
     - 文件类型 -type
       - find 路径 -type l  查找文件类型是链接的文件
       - find 路径 -type d 查找文件类型是目录的文件

   ---

   

5. 系统常用命令

   - top 查看系统资源消耗情况
   - free  查看内存使用情况 -m查看使用多少M
   - ps -ef  显示所有进程  |grep  mysql  检索mysql的进程
   - kill pid ，kill -9强制杀掉进程 pkill 进程名
   - init  0  关机  shutdown 关机 halt 关机 shutdown -h now立即关机 shutdown -h 10 10分钟后关机
   - init 1 重启 reboot 重启  shutdown -r now 现在重启 

   ---

   

6. 压缩打包命令

   - 常见的后缀名所对应的压缩工具

   | 后缀名  | 压缩方式                  |
   | ------- | ------------------------- |
   | .z      | compress工具压缩的文件    |
   | .bz2    | bzip2工具压缩的文件       |
   | .gz     | gzip工具压缩的文件        |
   | .tar    | tar工具打包的数据         |
   | .tar.gz | 先用tar打包，再用gzip压缩 |
   | .zip    | zip工具压缩               |

   

   - tar是在`linux`中使用得非常广泛的文档打包格式。它的好处就是它只消耗非常少的`cpu`以及时间去打包文件，但它仅仅只是一个打包工作，并不负责压缩

     - 语法：tar [-选项] [打包文件名] [需要打包的文件]

       选项

       1. -c：创建新的tar文件  create
       2. -v：显示运行过程信息 version
       3. -r：向压缩归档文件末尾追加文件
       4. -u：更新原压缩包中的文件 update
       5. -t：列出档案文件的内容，查看已经备份了哪些文件
       6. -x：解开tar文件
       7. -z：调用gzip压缩命令进行压缩
       8. -j：有bz2属性
       9. -Z：有compress属性
       10. -f：指定文件名 使用档案名字，切记，**这个参数是最后一个参数**，后面只能接档案名

     - 打包压缩命令

       ```shell
       1.将f1和f2文件打包到f1.tar中 
         tar -cf f1.tar f1 f2 不显示打包过程
         tar -cvf f1.tar f1 f2显示打包过程
       查看f1.tar中的文件 tar -tf f1.tar
       向f1.tar中追加文件f3  tar -rf f1.tar f3 
       修改f1文件内容并将文件更新到f1.tar中，tar -uf f1.tar f1
       2.解包 tar -vxf f1.tar -C /home 将f1.tar解包到指定home路径
       3.压缩
       tar -cvzf f1.tar.gz f1 f2 将f1文件打包成f1.tar.gz文件
       4.解压缩
       tar -zxf f1.tar.gz 将压缩包文件解压出 f1和f2,如果本地有会直接覆盖
       ```

   ---

   

7. 用户

   1.用户

   - 用户的信息都写在/etc/passwd的文件中

   - passwd一行记录

     root: x : 0 : 0 : root : /root : /bin/bash

     - root：用户名
     - x：密码或者\*来表示
     - 0：用户ID UID(user id)-->身份证号码
     - o：组ID GID(group id)-->组的编号
     - root：注释说明，该字段没有实际意义，通常记录该用户的一些属性
     - /root：root用户的家目录
     - /bin/bash：运行shell bash,sh,csh
     - /bin/false和/bin/nologin：该用户不允许登录

   2. 添加用户、设置密码

      1. 添加用户语法：useradd用户名

         `useradd test1` 新建test1用户

      2. 设置密码语法：passwd 用户名

         passwd 单独使用的时候，是给root用户去更改密码

         `passwd test1`给test1设置密码，设置密码的时候不会显示圆点和\*号

      2. 切换用户语法：su 用户名

         `su test1`

         `su root`

      **注意**：root切换成普通用户不用输入密码，普通用户切换成root，要输入密码，普通切换成普通，也要输入密码 

   3. 修改、删除用户

      1. 更改用户UID语法：usermod -u 新的id 用户名

         `usermod -u  1010 test1 `

      2. 将已有用户添加到已有组中

          `usermod -g 组名 用户名`

      3. 删除用户语法：userdel [-r] 用户名

         `userdel test1`只是删除了账户，文件信息保留在磁盘上

         `userdel -r test1`删除账户并包括用户创建的所有文件

      **注意**：删除某一个用户时，在passwd中对应的记录也会被删掉

   4. 组，用户组的命令

      - 组的信息都写在/etc/group的文件中

      - 分组

        - 一个组中可以包含多个用户，一个用户也可以属于多个组
        - 同组的用户，可以共享组内的所有资源，不同组的用户，是拥有不同的资源的使用权限

      - Group一行记录

        video : x : 33 : newer , wuxiaoyan,test1,test

        - video：组名
        - x：密码
        - 33：组编号GID
        - newer，test等是组中所包含的用户

      - 用户组操作

        1. 添加组语法：groupadd 组名
           - groupadd gro1 新建要给组，叫gro1
           - cat /etc/group 查看组是否新建成功
        2. 更改组id语法：groupmod -g 新的gid组名
           - groupmod -g 100 gro1 修改gro1的gid为100
        3. 删除组语法：groupdel 组名
           - gorupdel gro1 删除gro1组，如果该组中由用户，则无法删除该组

        **注意**：每创建一个组，就会在group中添加一条记录；如果删除一个组，这条记录也会被删除 

      - 用户、组信息查看

        1. 查看用户的用户id和组信息id语法：id 用户名

           id test1 查看test1用户的uid和gid，以及属于哪一个组

        2. 查看用户属于某组语法：groups 用户名

           groups test1 查看test1用户属于哪一个组

      ---

      

   5. 权限的理解

      1. 权限

         1. 查看，各字段含义

            `drwxr-xr-x  1 zhangjie UsersGrp  0 Nov  7 20:39 test`

         - d：文件的类型，d目录类型

         - rwx：第一组对应的是所属用户(u user) 对该文件的读、写、执行操作权限

         - r-x：第二组对应的是同组用户(g group)对该文件的读、执行操作权限

         - r-x：第三组对应的是同组用户(o other)对该文件的读、执行操作权限

         - zhangjie：所属的用户名(由哪个用户创建的)

         - UsersGrp：所在组的名称

         - 0：文件的大小

         - Nov  7 20:39：创建文件的时间

         - test：文件的名称

         2. 权限的表示

            1. 权限的第一种表达方式：用字符来表示
               - r：可读的权限 read 查看
               - w：可写的权限 write 更改
               - x：可执行的权限 excute 执行

            1. 权限的第二种表示方式：用数字来表示
               - 4：可读的权限 r
                 - 2：可写的权限 w
                 - 1：可执行的权限 x

      2. 权限的更改-所属者

         1. 更改文件的所属者方式来设置权限

            语法：chown [用户名] [文件名]  命令全称change owner

            chown -R [用户名] [文件目录] 递归修改目录下所有文件的所属用户

         3. 改变所在组和所属者来更改权限

            语法：chown [用户名]:[用户组名] [文件名]	

            chown -R [用户名]:[用户组名] [文件目录] 递归修改目录下所有文件的所属用户和所属组

         **注意**：这种操作只有root用户才有权限去操作，普通用户没有权限

      3. 权限的更改-所在组

         1. 更改文件的所在组方式来设置权限

            语法：chgrp [用户组名] [文件名] 命令全程 change group

         2. 改变所在组来改变权限-递归

            语法：chgrp -R [用户组名] [文件名]

         **注意**：这种操作只有root用户才有权限去操作，文件所有者也有权限

      4. 给用户设置指定的权限

         1. 通过字符的方式

            - 给指定的用户设置指定的权限

              语法：chmod 用户简称+权限 文件 命令全称change mode

            - 用户简称：所属用户：u(user) 同组用户：g(group) 其他用户：o(other) 所有用户：a(all)

            - 权限：rwx

         2. 通过数字设置权限

            - 对权限要求没有那么严格的文件可以采用这种方式

              语法：chmod nnn 文件，n表示数字，3个n表示3个数字

              例：chmod 755 test  表示 rwxr_xr_x

            **递归**：chmod -R 权限 [文件路径]

​	

